@page "/albums"

@inject IAlbumAPI Api
@inject IStatusStorage<ExceptionRequest> ExceptionRequest


@code {

    [CascadingParameter(Name = "loading")]
    public IStatusStorage<bool> Loading { get; set; } = null!;

    private AlbumDto[] Albums = [];

    protected override async Task OnInitializedAsync()
    {
        Loading.Value = true;

        var result = await Api.GetAlbums();

        Loading.Value = false;

        if (result.IsSuccessStatusCode)
        {
            Albums = result.Content ?? [];
        }
        else
        {
            ExceptionRequest.Value = new()
                {
                    Message = "Failed to load albums",
                    StatusCode = result.StatusCode
                };
        }
    }
}

<PageTitle>SastImg - Albums</PageTitle>

<AlbumList Albums="@Albums" />